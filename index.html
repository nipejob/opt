
<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Nikolaj ‚Äì Aktie forberedelsesskema (med kategorier)</title>

<style>
:root{
  --bg:#f2f3f5;
  --panel:#ffffff;
  --text:#1f2937;
  --muted:#6b7280;

  --green:#2e7d32;    /* Ja */
  --red:#e53935;      /* Nej */
  --yellow:#f9a825;   /* Ved ikke */
  --blue:#1565c0;     /* Tjek */
  --accent:#ef6c00;   /* Overskrift/accent */

  --radius:12px;
  --pad:12px;
  --font:15px;
  --font-small:13px;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  font-size:var(--font);
  -webkit-tap-highlight-color: transparent;
}

.container{
  max-width:900px;
  margin:18px auto 80px;
  padding:0 12px;
}

.section{
  background:var(--panel);
  border-radius:var(--radius);
  padding:var(--pad);
  margin-bottom:14px;
  box-shadow:0 8px 18px rgba(0,0,0,.06);
}

h1,h2{ margin:0 0 6px; }
.sub{ color:var(--muted); margin:0 0 6px; font-size:var(--font-small); }

/* Topv√¶rkt√∏jer (tema) */
.tools{
  display:flex; align-items:center; gap:10px; flex-wrap:wrap;
}
.select{
  appearance:none;
  background:#fff;
  border:1px solid #d1d5db;
  border-radius:10px;
  padding:6px 10px;
  font-weight:600;
  font-size:var(--font-small);
}

/* Grupper/kategorier */
.group{
  border:2px solid #ffd7b5;
  border-radius:12px;
  padding:10px;
  margin-top:10px;
  background:#fff;
}
.group-head{
  display:flex; align-items:center; gap:8px; margin-bottom:6px;
  color:var(--accent); font-weight:800;
}
.group.complete{
  background:#e8f5e9; border-color:#a5d6a7;
}
.group.complete .group-head{ color:var(--green); }
.badge{
  margin-left:auto;
  padding:3px 8px; border-radius:999px; background:#d7f0dc; font-size:12px; display:none;
}
.group.complete .badge{ display:inline-block; }

/* Sp√∏rgsm√•l ‚Äì kompakt */
.question{
  border:1px solid #e5e7eb;
  border-radius:10px;
  background:#fafafa;
  padding:10px;
  margin-top:8px;
  display:grid;
  grid-template-columns: 1fr auto;
  gap:8px;
}
.question.correct{ border:2px solid var(--green); background:#e8f5e9; }
.question.wrong{   border:2px solid var(--red);   background:#fdecea; }

.q-left{ display:flex; gap:8px; align-items:flex-start; }
.q-num{
  width:26px; height:26px; border-radius:6px;
  background:#bbdefb; color:#0f172a; font-weight:800;
  display:flex; align-items:center; justify-content:center;
  flex:0 0 auto; font-size:13px; margin-top:1px;
}
.q-icon{
  width:26px; height:26px; border-radius:6px;
  background:#fff; border:1px solid #e5e7eb;
  display:flex; align-items:center; justify-content:center;
  flex:0 0 auto; user-select:none; font-size:16px; margin-top:1px;
}
.q-text{ line-height:1.3; }

/* Knapper ‚Äì mobilvenlige */
.actions{ display:flex; gap:6px; flex-wrap:wrap; justify-content:flex-end; }
.btn{
  border:none; border-radius:9px; padding:6px 10px;
  font-weight:800; cursor:pointer; font-size:14px;
  box-shadow:0 1px 6px rgba(0,0,0,.07);
  min-height:34px;
}
.btn:active{ transform:translateY(1px); }

.yes{ background:var(--green); color:#fff; }
.no{  background:var(--red);   color:#fff; }
.unk{ background:var(--yellow); color:#111; }
.check{ background:var(--blue); color:#fff; }

/* Endeligt banner */
#final-banner{ display:none; margin-top:12px; }
#final-banner .inner{
  padding:16px;
  border-radius:16px;
  background:linear-gradient(135deg,#2e7d32,#66bb6a);
  color:#fff; text-align:center;
  font-size:1.2rem; font-weight:900;
  box-shadow:0 12px 28px rgba(0,0,0,.25);
}

/* PDF-panel kompakt */
.form-row{
  display:flex; gap:8px; flex-wrap:wrap; align-items:flex-end;
}
.input{
  padding:8px 10px; border-radius:10px; border:1px solid #d1d5db;
  font-size:14px; min-width:160px;
}
label{ font-size:12px; color:#374151; font-weight:700; }

/* iPhone-tilpasning */
@media (max-width:480px){
  :root{
    --pad:10px;
    --font:14px;
    --font-small:12px;
  }
  .question{ grid-template-columns: 1fr; }
  .actions{ justify-content:flex-start; }
  .btn{ padding:6px 9px; font-size:13px; min-height:32px; }
  .q-num,.q-icon{ width:24px; height:24px; font-size:14px; }
}
</style>
</head>

<body>
<div class="container">

  <!-- Topbar -->
  <div class="section">
    <h1>üß† Aktie‚Äëcheckliste f√∏r k√∏b</h1>
    <p class="sub">Nikolaj ‚Äì Forberedelsesskema (med kategorier)</p>
    <div class="tools">
      <label for="theme" class="sub" style="font-weight:800">Ikon‚Äëtema</label>
      <select id="theme" class="select" aria-label="V√¶lg ikon-tema">
        <option value="penge">üí∞ Penge</option>
        <option value="frugt">üçé Frugter</option>
      </select>
      <button id="resetAll" class="btn" style="background:#fff;border:1px solid #e5e7eb;color:#111;">Nulstil alle</button>
    </div>
  </div>

  <!-- Liste med kategorier og sp√∏rgsm√•l -->
  <div id="groups" class="section"></div>

  <!-- PDF-eksport -->
  <div class="section">
    <h2>üìÑ PDF‚Äëeksport</h2>
    <div class="form-row" style="margin-top:6px">
      <div>
        <label for="pdf-firma">Firma</label><br>
        <input id="pdf-firma" class="input" placeholder="Fx Novo Nordisk">
      </div>
      <div>
        <label for="pdf-kurs">Kurs</label><br>
        <input id="pdf-kurs" class="input" placeholder="Fx 945,50">
      </div>
      <button id="btn-pdf" class="btn check">‚¨á Download PDF</button>
    </div>
    <p class="sub" style="margin-top:6px">Dato inds√¶ttes automatisk. PDF‚Äôen indeholder kategorier, alle sp√∏rgsm√•l, dine svar og endelig vurdering.</p>
  </div>

  <!-- OKAY-banner -->
  <div id="final-banner" class="section">
    <div class="inner">
      ‚úÖ OKAY TIL K√òB / SLAG
      <div style="font-size:.95rem;font-weight:600;margin-top:6px">
        Alle 21 punkter er korrekt vurderet
      </div>
    </div>
  </div>

</div>

<!-- jsPDF (CDN) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-YkY0QmHn+e0Q2b9f0H6oQ9r1u0b8rQ1n54tZpYJYgJXzO4Q6GmW3S9+0zv0l0o1f4Qx0Hc3p3y3M6aJkUq4w0A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
/* ====== Data (kategorier + sp√∏rgsm√•l) ====== */
const GROUPS = [
  {
    title: "Strategi & timing",
    items: [
      "Handler jeg ud fra min strategi ‚Äì og ikke mit hum√∏r?",
      "Er det ikke fredag, eller har jeg en meget god grund?",
      "Har jeg klart defineret indgangs- og udgangskurs?",
      "Findes der bedre alternativer end slagk√∏b (fx delk√∏b/DCA)?",
      "Kan k√∏bet vente, eller er det reelt bare FOMO?"
    ]
  },
  {
    title: "Fundamentalt",
    items: [
      "Er det en udbytteaktie, og passer det til min strategi?",
      "Er kursbev√¶gelsen baseret p√• reel udvikling ‚Äì ikke kun en nyhed?",
      "Matcher casen det overordnede forl√∏b / trend?"
    ]
  },
  {
    title: "Valuta & aktietype",
    items: [
      "Er aktien handlet i EUR?",
      "Er den handlet i DKK, SEK eller NOK?",
      "Er det en A- eller B-aktie, og har jeg taget h√∏jde for forskellen?"
    ]
  },
  {
    title: "Risiko & portef√∏lje",
    items: [
      "Passer positionens st√∏rrelse til min portef√∏lje",
      "Har jeg allerede for h√∏j eksponering mod samme sektor eller tema?",
      "Er likviditeten h√∏j nok til, at jeg kan komme ud uden problemer?"
    ]
  },
  {
    title: "Exit & robusthed",
    items: [
      "Hvad er mit konkrete exit-scenarie, hvis jeg tager fejl?",
      "Er der en kommende begivenhed, jeg reelt gambler p√• (regnskab, rente, dom, FDA, guidance)?",
      "Hvad er det v√¶rste realistiske scenarie ‚Äì og kan jeg leve med det?",
      "Er casen stadig gyldig, hvis markedet falder 5‚Äì10 %?"
    ]
  },
  {
    title: "Adf√¶rd & bias",
    items: [
      "K√∏ber jeg pga. andres overbevisning ‚Äì eller min egen analyse?",
      "Hvis jeg ikke ejede aktien i dag ‚Äì ville jeg s√• k√∏be den nu?"
    ]
  },
  {
    title: "Kvalitetssikring",
    items: [
      "Er alle oplysninger korrekt udfyldt og dobbelttjekket?"
    ]
  }
];

/* Facit (dine korrekte svar) ‚Äì 21 stk i r√¶kkef√∏lge 1..21 */
const ANSWER_KEY = [
 'yes','yes','yes','unk','no',
 'yes','yes','yes','no','yes',
 'yes','yes','no','yes','unk',
 'no','yes','yes','yes','yes','yes'
];

/* Ikon-temaer */
const ICONS = {
  penge: ['üí∞','üìà','ü™ô','üíπ','üè¶','üíµ','üí≥','üìä','üßæ','üíº','üìâ','üí∏','üèõÔ∏è','üí±','üßÆ','üîç','üõ°Ô∏è','‚úÖ','üìà','üí∞','üí≥','üíπ','üíµ','üè¶'],
  frugt: ['üçé','üçê','üçä','üçã','üçå','üçâ','üçá','üçì','ü´ê','üçí','üçç','ü•ù','üçë','ü•≠','üçà','üçè','üçé','üçá','üçì','üçç','üçä','üçí','üçã','üçê']
};
let currentTheme = 'penge';

/* State */
const answers = new Array(ANSWER_KEY.length).fill(null);

/* ====== Rendering ====== */
const groupsHost = document.getElementById('groups');

function iconFor(idx){
  const set = ICONS[currentTheme] || ICONS.penge;
  return set[idx % set.length];
}

function renderAll(){
  groupsHost.innerHTML = '';
  let qIdx = 0;
  GROUPS.forEach((g,gIndex)=>{
    const gEl = document.createElement('div');
    gEl.className = 'group';
    const head = document.createElement('div');
    head.className = 'group-head';
    const title = document.createElement('div');
    title.textContent = g.title;
    const badge = document.createElement('div');
    badge.className = 'badge';
    badge.textContent = '‚úÖ Afsluttet';
    head.append(title, badge);
    gEl.appendChild(head);

    const idxs = [];

    g.items.forEach((text)=>{
      const i = qIdx++;
      idxs.push(i);

      const q = document.createElement('div');
      q.className = 'question';
      q.dataset.index = i;

      q.innerHTML = `
        <div class="q-left">
          <div class="q-num">${i+1}</div>
          <div class="q-icon" data-icon="${i}">${iconFor(i)}</div>
          <div class="q-text">${text}</div>
        </div>
        <div class="actions">
          <button class="btn yes"  aria-label="Svar ja">Ja</button>
          <button class="btn no"   aria-label="Svar nej">Nej</button>
          <button class="btn unk"  aria-label="Svar ved ikke">Ved ikke</button>
          <button class="btn check" aria-label="Tjek svar">Tjek</button>
        </div>
      `;

      const [bYes,bNo,bUnk,bCheck] = q.querySelectorAll('button');
      bYes.onclick  = ()=>{ answers[i]='yes'; q.classList.remove('correct','wrong'); updateGroupStates(); };
      bNo.onclick   = ()=>{ answers[i]='no';  q.classList.remove('correct','wrong'); updateGroupStates(); };
      bUnk.onclick  = ()=>{ answers[i]='unk'; q.classList.remove('correct','wrong'); updateGroupStates(); };
      bCheck.onclick = ()=>{
        if(!answers[i]){ alert('Svar f√∏rst'); return; }
        q.classList.remove('correct','wrong');
        q.classList.add(answers[i]===ANSWER_KEY[i] ? 'correct' : 'wrong');
        updateGroupStates();
        updateFinalBanner();
      };

      gEl.appendChild(q);
    });

    gEl.dataset.indexes = idxs.join(',');
    groupsHost.appendChild(gEl);
  });
}

/* Opdater ikoner n√•r tema skiftes */
const themeSel = document.getElementById('theme');
themeSel.addEventListener('change', ()=>{
  currentTheme = themeSel.value;
  document.querySelectorAll('[data-icon]').forEach(icon=>{
    const idx = Number(icon.getAttribute('data-icon'));
    icon.textContent = iconFor(idx);
  });
});

/* Nulstil alt */
document.getElementById('resetAll').addEventListener('click', ()=>{
  answers.fill(null);
  document.querySelectorAll('.question').forEach(q=>{
    q.classList.remove('correct','wrong');
  });
  document.getElementById('final-banner').style.display='none';
  updateGroupStates();
});

/* Gruppe-fuldf√∏relse (gr√∏n n√•r alle dens sp√∏rgsm√•l er korrekte) */
function updateGroupStates(){
  document.querySelectorAll('.group').forEach(g=>{
    const idxs = (g.dataset.indexes||'').split(',').filter(Boolean).map(Number);
    const complete = idxs.length>0 && idxs.every(i => answers[i] && answers[i]===ANSWER_KEY[i]);
    g.classList.toggle('complete', complete);
  });
}

/* OKAY-banner (kun hvis ALT er korrekt) */
function updateFinalBanner(){
  const ok = answers.every((a,i)=> a && a===ANSWER_KEY[i]);
  document.getElementById('final-banner').style.display = ok ? 'block' : 'none';
}

/* ====== PDF-eksport ====== */
document.getElementById('btn-pdf').addEventListener('click', exportPDF);

function exportPDF(){
  const ok = answers.every((a,i)=> a && a===ANSWER_KEY[i]);
  if(!ok){ alert('Checklist skal v√¶re fuldt godkendt (alle korrekt) f√∏r eksport.'); return; }

  const firma = document.getElementById('pdf-firma').value.trim();
  const kurs  = document.getElementById('pdf-kurs').value.trim();
  if(!firma || !kurs){ alert('Udfyld b√•de Firma og Kurs.'); return; }

  const isoDate = new Date().toISOString().slice(0,10); // YYYY-MM-DD
  const daDate  = new Date().toLocaleDateString('da-DK');

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit:'mm', format:'a4' });

  const margin = 14;
  let y = margin;

  doc.setFont('helvetica','bold'); doc.setFontSize(16);
  doc.text('Aktie ‚Äì Forberedelsesskema', margin, y);
  y += 8;

  doc.setFont('helvetica','normal'); doc.setFontSize(11);
  doc.text(`Firma: ${firma}`, margin, y); y += 6;
  doc.text(`Kurs: ${kurs}`, margin, y);  y += 6;
  doc.text(`Dato: ${daDate}`, margin, y); y += 8;

  doc.setFont('helvetica','bold'); doc.text('Resultat:', margin, y); y += 6;
  doc.setFont('helvetica','normal');
  doc.text('‚úÖ OKAY TIL K√òB / SLAG', margin, y); y += 8;

  // Checkliste med kategorier
  GROUPS.forEach((g, gi)=>{
    doc.setFont('helvetica','bold'); doc.text(g.title, margin, y); y += 6;
    doc.setFont('helvetica','normal');

    const pageHeight = doc.internal.pageSize.getHeight();
    const maxWidth = doc.internal.pageSize.getWidth() - margin*2;

    g.items.forEach((text, localIdx)=>{
      // globalt index i ANSWER_KEY
      const globalIndex = GROUPS.slice(0,gi).reduce((n,gg)=>n+gg.items.length,0) + localIdx;
      const aLbl = answers[globalIndex]==='yes' ? 'Ja' : answers[globalIndex]==='no' ? 'Nej' : 'Ved ikke';
      const correct = answers[globalIndex]===ANSWER_KEY[globalIndex];
      const mark = correct ? '‚úÖ' : '‚ùå';

      const lineQ = doc.splitTextToSize(`${globalIndex+1}. ${text}`, maxWidth);
      const lineA = [`Svar: ${aLbl}  ${mark}`];

      const blockHeight = lineQ.length*5 + lineA.length*5 + 3;
      if(y + blockHeight > pageHeight - margin){
        doc.addPage(); y = margin;
      }
      doc.text(lineQ, margin, y); y += lineQ.length*5;
      doc.text(lineA, margin, y); y += lineA.length*5 + 3;
    });

    y += 2;
  });

  const safeName = firma.replace(/[^A-Za-z0-9_-]+/g,'_').replace(/_+/g,'_');
  const filename = `${isoDate}_${safeName}_Forberedelsesskema.pdf`;
  doc.save(filename);
}

/* Init */
renderAll();
updateGroupStates();
updateFinalBanner();
</script>
</body>
</html>
