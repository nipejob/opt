<!DOCTYPE html>

<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚è≥ Opt√¶lling</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 15px;
    }
   
    .container {
        max-width: 500px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
   
    h1 {
        text-align: center;
        color: #333;
        margin-bottom: 20px;
        font-size: 24px;
    }
   
    .categories {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
        margin-bottom: 30px;
    }
   
    .category {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 12px 8px;
        border-radius: 12px;
        color: white;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.1s;
        user-select: none;
        min-height: 75px;
    }
   
    .category:active {
        transform: scale(0.98);
    }
   
    .category-name {
        font-size: 13px;
        text-align: center;
        margin-bottom: 5px;
    }
   
    .category-count {
        font-size: 20px;
        background: rgba(255,255,255,0.3);
        padding: 4px 10px;
        border-radius: 20px;
    }
   
    .slik { background: #dc2626; }
    .org { background: #f97316; }
    .mastro { background: #4b5563; }
    .chokolade { background: #78350f; }
    .quick50 { background: #065f46; }
    .aktier { background: #6b21a8; }
    .blandet { background: #1e40af; }
    .trist { background: #064e3b; }
    .guld { background: #ca8a04; }
   
    .qr-section {
        text-align: center;
        padding: 20px;
        background: #f9fafb;
        border-radius: 12px;
    }
   
    #qrcode {
        display: inline-block;
        padding: 10px;
        background: white;
        border-radius: 8px;
        margin-bottom: 15px;
    }
   
    .qr-info {
        font-size: 13px;
        color: #6b7280;
        margin-bottom: 15px;
    }
    
    .save-btn {
        width: 100%;
        padding: 14px;
        background: #10b981;
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        font-size: 15px;
        margin-bottom: 10px;
        text-decoration: none;
        display: block;
        text-align: center;
    }
    
    .save-btn:hover {
        background: #059669;
    }
    
    .save-btn.disabled {
        background: #9ca3af;
        cursor: not-allowed;
    }
    
    .instructions {
        background: #fef3c7;
        border: 2px solid #f59e0b;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 15px;
        font-size: 13px;
        color: #78350f;
    }
    
    .instructions strong {
        color: #92400e;
    }
    
    .url-display {
        margin-top: 15px;
        padding: 10px;
        background: white;
        border-radius: 8px;
        font-size: 11px;
        word-break: break-all;
        color: #6b7280;
    }
</style>
```

</head>
<body>
    <div class="container">
        <h1>‚è≥ Opt√¶lling</h1>

```
    <div class="categories" id="categories"></div>
   
    <div class="qr-section">
        <div class="instructions">
            <strong>üì± iPhone Guide:</strong><br>
            1. T√¶l dine kategorier<br>
            2. Klik "GEM & OPRET LINK"<br>
            3. Klik p√• det gr√∏nne link<br>
            4. Tilf√∏j til bogm√¶rker i Safari (Del ‚Üí Tilf√∏j bogm√¶rke)
        </div>
        
        <button class="save-btn" onclick="saveData()">üíæ GEM & OPRET LINK</button>
        
        <a href="#" id="savedLink" class="save-btn disabled" style="display: none;">
            üîó √ÖBEN GEMT DATA
        </a>
        
        <div id="qrcode" style="display: none;"></div>
        <div class="qr-info" id="qrInfo">Klik GEM for at oprette dit data-link</div>
    </div>
</div>

<script>
    const categories = [
        { name: 'Slik', class: 'slik', id: 'S' },
        { name: 'Org', class: 'org', id: 'O' },
        { name: 'Mastro', class: 'mastro', id: 'M' },
        { name: 'Chokolade', class: 'chokolade', id: 'C' },
        { name: 'Quick50', class: 'quick50', id: 'Q' },
        { name: 'Aktier', class: 'aktier', id: 'A' },
        { name: 'Blandet', class: 'blandet', id: 'B' },
        { name: 'Trist', class: 'trist', id: 'T' },
        { name: 'Guld opl. 3', class: 'guld', id: 'G' }
    ];
   
    let entries = [];
   
    // INDL√ÜS DATA FRA URL
    function loadFromURL() {
        const params = new URLSearchParams(window.location.search);
        const data = params.get('d');
        if (data) {
            try {
                const decoded = JSON.parse(atob(data));
                entries = decoded.map(e => ({
                    category: categories.find(c => c.id === e.c)?.name || e.c,
                    timestamp: new Date(e.t).toISOString()
                }));
                console.log('Data indl√¶st:', entries.length, 'registreringer');
            } catch (e) {
                console.error('Fejl ved indl√¶sning:', e);
                entries = [];
            }
        }
    }
   
    // GEM DATA OG OPRET LINK
    function saveData() {
        if (entries.length === 0) {
            alert('‚ö†Ô∏è Ingen data at gemme. T√¶l f√∏rst nogle kategorier!');
            return;
        }
        
        const compact = entries.map(e => ({
            c: categories.find(c => c.name === e.category)?.id || e.category,
            t: new Date(e.timestamp).getTime()
        }));
        const encoded = btoa(JSON.stringify(compact));
        const baseURL = window.location.href.split('?')[0];
        const fullURL = baseURL + '?d=' + encoded;
        
        // Opdater link
        const linkElement = document.getElementById('savedLink');
        linkElement.href = fullURL;
        linkElement.style.display = 'block';
        linkElement.classList.remove('disabled');
        
        // Opdater info
        document.getElementById('qrInfo').innerHTML = 
            `‚úÖ Data gemt! Klik p√• det gr√∏nne link og tilf√∏j til bogm√¶rker.<br>
            <small style="color: #9ca3af;">N√¶ste gang: √Öbn bogm√¶rket for at forts√¶tte</small>`;
        
        alert('‚úÖ Data gemt!\n\nüì± iPhone: Klik p√• det gr√∏nne link og tilf√∏j til bogm√¶rker i Safari.');
    }
   
    // TILF√òJ NY OPT√ÜLLING
    function addEntry(categoryName) {
        const now = new Date();
        entries.push({
            category: categoryName,
            timestamp: now.toISOString()
        });
        render();
    }
   
    // BEREGN TOTALER
    function getCounts() {
        const counts = {};
        categories.forEach(cat => counts[cat.name] = 0);
        entries.forEach(entry => {
            if (counts[entry.category] !== undefined) {
                counts[entry.category]++;
            }
        });
        return counts;
    }
   
    // VIS KATEGORIER
    function render() {
        const counts = getCounts();
        const categoriesDiv = document.getElementById('categories');
        categoriesDiv.innerHTML = '';
       
        categories.forEach(cat => {
            const div = document.createElement('div');
            div.className = `category ${cat.class}`;
            div.onclick = () => addEntry(cat.name);
            div.innerHTML = `
                <span class="category-name">${cat.name}</span>
                <span class="category-count">${counts[cat.name]}</span>
            `;
            categoriesDiv.appendChild(div);
        });
    }
   
    // START
    loadFromURL();
    render();
</script>
```

</body>
</html>